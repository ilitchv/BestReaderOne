 <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NYC Road Test Evaluation System</title>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <style>
        :root {
            --primary: #2563eb;
            --danger: #dc2626;
            --success: #16a34a;
            --background: linear-gradient(135deg, #1e3a8a 0%, #0f172a 100%);
            --glass: rgba(255, 255, 255, 0.05);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', sans-serif;
        }

        body {
            min-height: 100vh;
            background: var(--background);
            color: white;
            padding: 2rem;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            backdrop-filter: blur(16px) saturate(180%);
            -webkit-backdrop-filter: blur(16px) saturate(180%);
            background-color: var(--glass);
            border-radius: 1rem;
            border: 1px solid rgba(255, 255, 255, 0.125);
            padding: 2rem;
        }

        .header-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .input-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .input-group input, .input-group select {
            padding: 0.75rem;
            border-radius: 0.5rem;
            border: 1px solid var(--primary);
            background: rgba(0, 0, 0, 0.3);
            color: white;
        }

        .button-group {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .button {
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            border: none;
            cursor: pointer;
            transition: transform 0.2s;
            background: var(--primary);
            color: white;
        }

        .button:hover {
            transform: translateY(-2px);
        }

        .button.reset {
            background: var(--danger);
        }

        .button.report {
            background: var(--success);
        }

        .timer {
            font-size: 1.2rem;
            text-align: center;
            margin: 1rem 0;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 1000;
        }

        .modal-content {
            position: relative;
            background: white;
            color: black;
            margin: 5% auto;
            padding: 2rem;
            width: 80%;
            max-width: 600px;
            border-radius: 0.5rem;
        }

        .close-modal {
            position: absolute;
            right: 1rem;
            top: 1rem;
            cursor: pointer;
            font-size: 1.5rem;
        }

        #reportSection {
            position: absolute;
            left: -9999px;
            width: 210mm;
            padding: 2cm;
            background: white;
            color: black;
            border-radius: 0.5rem;
        }

        .item-number {
            display: inline-block;
            width: 30px;
            font-weight: bold;
            color: var(--primary);
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 style="text-align: center; margin-bottom: 2rem;">ðŸš— NYC Road Test Evaluation System</h1>
        
        <div class="header-section">
            <div class="input-group">
                <label>Student Name:</label>
                <input type="text" id="studentName" onblur="startTimer()">
            </div>
            <div class="input-group">
                <label>Inspector Name:</label>
                <input type="text" id="inspectorName">
            </div>
            <div class="input-group">
                <label>Exam Date:</label>
                <input type="date" id="examDate">
            </div>
            <div class="input-group">
                <label>Start Time:</label>
                <input type="time" id="examTime" readonly>
            </div>
        </div>

        <div class="timer" id="examTimer">Elapsed Time: 00:00:00</div>

        <div class="button-group">
            <button type="button" class="button reset" onclick="resetForm()">Reset Form</button>
            <button type="button" class="button report" onclick="generateReport()">Download Report</button>
        </div>

        <div class="grid" id="evaluationForm">
            <!-- Categories inserted by JavaScript -->
        </div>

        <div class="modal" id="infoModal">
            <div class="modal-content">
                <span class="close-modal" onclick="closeModal()">&times;</span>
                <div id="modalContent"></div>
            </div>
        </div>

        <div id="reportSection">
            <div class="report-header">
                <h2>NYC Road Test Evaluation Report</h2>
                <p>Student: <span id="reportStudentName"></span></p>
                <p>Inspector: <span id="reportInspectorName"></span></p>
                <p>Date: <span id="reportExamDate"></span></p>
                <p>Start Time: <span id="reportExamTime"></span></p>
                <p>Test Duration: <span id="reportExamDuration"></span></p>
            </div>
            <div id="reportContent"></div>
            <div class="report-footer">
                <p>Total Points: <span id="reportTotalPoints"></span></p>
                <p>Result: <span id="reportResult"></span></p>
            </div>
        </div>
    </div>

    <script>
        // ConfiguraciÃ³n inicial
        let startTime = null;
        let timerInterval = null;
        const explanations = {
            1: "Proper observation includes checking mirrors, blind spots, and surrounding traffic. (NYC Driver's Manual, Section 5.2)",
            2: "Signal must be activated at least 100 feet before turning. (NYC Traffic Rules Â§4-03)",
            // Agrega todas las explicaciones necesarias...
        };

        // Datos completos del examen
        const categories = [
            {
                title: "A. LEAVING CURB",
                items: [
                    { number: 1, text: "Fails to observe", points: 10, subItems: [] },
                    { number: 2, text: "Fails to signal", points: 5, subItems: [] },
                    { number: 3, text: "Uses mirror only/fails to check blind spot", points: 5, subItems: [] }
                ]
            },
            {
                title: "B. TURNING/INTERSECTIONS",
                items: [
                    { number: 4, text: "Poor judgment approaching or at intersections", points: 10, 
                      subItems: ["Speed", "Turning", "Right of Way", "Following Distance", "Other"] },
                    { number: 5, text: "Fails to stop near center of intersection when waiting to make left turn", points: 10, subItems: [] },
                    { number: 6, text: "Turns wide - short right", points: 5, subItems: [] },
                    { number: 7, text: "Turns wide - short left", points: 5, subItems: [] },
                    { number: 8, text: "Inattentive to traffic", points: 10, 
                      subItems: ["Signs", "Signals", "Lane Markings"] }
                ]
            },
            // ContinÃºa con las demÃ¡s categorÃ­as...
        ];

        // Generar formulario
        function generateForm() {
            const form = document.getElementById('evaluationForm');
            categories.forEach(category => {
                const categoryHTML = `
                    <div class="category">
                        <h2>${category.title}</h2>
                        <div class="checkbox-group">
                            ${category.items.map(item => `
                                <div>
                                    <label class="checkbox-label" onclick="showExplanation(${item.number})">
                                        <span class="item-number">${item.number}</span>
                                        <input type="checkbox" data-points="${item.points}">
                                        <span>${item.text}</span>
                                        <span class="points-badge">-${item.points}</span>
                                    </label>
                                    ${item.subItems.length > 0 ? `
                                        <div class="sub-item">
                                            ${item.subItems.map(sub => `
                                                <label class="checkbox-label">
                                                    <input type="checkbox">
                                                    <span>${sub}</span>
                                                </label>
                                            `).join('')}
                                        </div>
                                    ` : ''}
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
                form.insertAdjacentHTML('beforeend', categoryHTML);
            });
        }

        // Funciones del temporizador
        function startTimer() {
            if (!startTime) {
                startTime = new Date();
                document.getElementById('examTime').value = 
                    startTime.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
                timerInterval = setInterval(updateTimer, 1000);
            }
        }

        function updateTimer() {
            const now = new Date();
            const diff = Math.floor((now - startTime) / 1000);
            const hours = Math.floor(diff / 3600);
            const minutes = Math.floor((diff % 3600) / 60);
            const seconds = diff % 60;
            document.getElementById('examTimer').textContent = 
                `Elapsed Time: ${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        }

        // Funciones del modal
        function showExplanation(itemNumber) {
            document.getElementById('modalContent').innerHTML = `
                <h3>Item ${itemNumber} Requirements</h3>
                <p>${explanations[itemNumber]}</p>
                <small>Reference: NYC Driver's Manual Chapter 5</small>
            `;
            document.getElementById('infoModal').style.display = 'block';
        }

        function closeModal() {
            document.getElementById('infoModal').style.display = 'none';
        }

        // Generar reporte
        async function generateReport() {
            // Capturar datos del formulario
            const reportData = {
                student: document.getElementById('studentName').value,
                inspector: document.getElementById('inspectorName').value,
                date: document.getElementById('examDate').value,
                time: document.getElementById('examTime').value,
                duration: document.getElementById('examTimer').textContent.replace('Elapsed Time: ', '')
            };

            // Configurar datos del reporte
            document.getElementById('reportStudentName').textContent = reportData.student;
            document.getElementById('reportInspectorName').textContent = reportData.inspector;
            document.getElementById('reportExamDate').textContent = reportData.date;
            document.getElementById('reportExamTime').textContent = reportData.time;
            document.getElementById('reportExamDuration').textContent = reportData.duration;

            // Generar imagen
            const reportElement = document.getElementById('reportSection');
            const canvas = await html2canvas(reportElement);
            const image = canvas.toDataURL('image/png');

            // Descargar reporte
            const link = document.createElement('a');
            link.download = `RoadTestReport-${Date.now()}.png`;
            link.href = image;
            link.click();
        }

        // Inicializar
        generateForm();
    </script>
</body>
</html>
