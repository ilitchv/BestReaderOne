<!DOCTYPE html>
<html lang="es">
<!-- Engine: v7.0 Modular (Lotto + Horses) -->

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Beast Strategy Sniper v7.0 (Modular)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
        href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700&family=Roboto:wght@300;400;500;700&display=swap"
        rel="stylesheet">

    <!-- MODULAR CSS -->
    <link rel="stylesheet" href="css/sniper-ui.css">
</head>

<body>

    <div class="main-layout">

        <!-- HEADER -->
        <div class="top-section">
            <div class="flex justify-between items-end mb-4 px-1">
                <div class="flex items-center gap-3">
                    <div class="settings-gear" onclick="openSettings()" title="Configuraci√≥n">‚öôÔ∏è</div>
                    <div>
                        <h1 class="text-xl font-bold font-tech tracking-wider text-white flex items-center gap-2">
                            <span class="text-cyan-500">SNIPER</span> DASHBOARD v7.0
                        </h1>
                        <p class="text-[10px] text-slate-500 font-mono mt-1" id="configSummary">CONF: LOADING...</p>
                    </div>
                </div>
                <div class="flex items-center gap-4 bg-slate-900/50 p-2 rounded-lg border border-slate-700">
                    <span class="text-xs font-bold text-slate-400">GAME:</span>
                    <select id="engineSelect"
                        class="bg-slate-800 text-cyan-400 text-xs font-bold border-none focus:outline-none uppercase"
                        onchange="window.switchEngine(this.value)">
                        <option value="LOTTO">Lotto (Pick3/Win4)</option>
                        <option value="HORSE">NY Horses (Racing)</option>
                    </select>
                </div>
                <div class="text-right">
                    <div class="flex items-center justify-end gap-2 mb-1">
                        <span class="text-[10px] font-bold text-slate-500 uppercase tracking-wider"
                            id="modeLabel">SIMULATION</span>
                        <label class="relative inline-flex items-center cursor-pointer">
                            <input type="checkbox" id="modeToggle" class="sr-only peer"
                                onchange="toggleExecutionMode()">
                            <div
                                class="w-8 h-4 bg-slate-700 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-3 after:w-3 after:transition-all peer-checked:bg-red-600">
                            </div>
                        </label>
                    </div>
                    <span class="text-[10px] text-slate-500 uppercase tracking-wider block">P&L GLOBAL</span>
                    <span class="text-2xl font-bold font-tech balance-gradient" id="totalBalance">$0.00</span>
                </div>
            </div>

            <!-- CONTROL PANEL -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">

                <!-- 1. DATA LOADER -->
                <div class="glass-card p-4 flex flex-col justify-between h-36 admin-only">
                    <div class="flex justify-between items-center mb-1">
                        <h3 class="text-[10px] font-bold text-slate-500 uppercase tracking-widest">Cargar Tracks</h3>
                        <div class="w-1.5 h-1.5 rounded-full bg-slate-600" id="dataDot"></div>
                    </div>

                    <div class="flex gap-2 mb-2">
                        <select id="lotterySelect"
                            class="bg-slate-900 border border-slate-700 text-white text-xs rounded px-2 py-1 w-full focus:outline-none focus:border-cyan-500">
                            <!-- Todas las loter√≠as -->
                            <option value="Texas">Texas (All)</option>
                            <option value="Georgia">Georgia (All)</option>
                            <option value="Florida">Florida (All)</option>
                            <option value="New York">New York (All)</option>
                            <option value="New York Horse">New York Horses (NEW)</option>
                        </select>
                    </div>

                    <div class="flex gap-2 mb-1">
                        <label
                            class="flex-1 flex flex-col items-center justify-center border border-dashed border-slate-700 rounded bg-slate-800/30 hover:bg-slate-800 hover:border-cyan-500/50 cursor-pointer transition group h-[30px]">
                            <span id="fileName"
                                class="text-[10px] font-medium text-slate-400 group-hover:text-cyan-400 truncate w-full text-center px-1">+
                                CSV</span>
                            <input type="file" id="csvInput" accept=".csv" class="hidden">
                        </label>
                        <button class="btn-tool flex-1 justify-center" onclick="openConverter()">
                            <span>üõ†Ô∏è</span> Convertir
                        </button>
                    </div>

                    <button id="btnDownload" class="btn-download py-1.5 px-4 text-[10px] uppercase tracking-wide w-full"
                        disabled onclick="downloadCSV()">
                        <span>üì•</span> Exportar Data
                    </button>
                </div>

                <!-- 2. SNIPER REEL 3D -->
                <div class="glass-card h-36 relative overflow-hidden flex flex-col p-0">
                    <div id="pulseBg"
                        class="absolute top-0 right-0 w-24 h-24 bg-cyan-500/5 rounded-full blur-2xl transition-colors duration-500 z-0">
                    </div>
                    <div class="absolute top-2 left-4 z-20 pointer-events-none">
                        <h3 class="text-[10px] font-bold text-slate-500 uppercase tracking-widest">Radar de
                            Oportunidades</h3>
                    </div>
                    <div class="absolute top-2 right-4 z-20 pointer-events-none">
                        <span class="text-[10px] text-cyan-400 font-mono" id="activeCount">0 Activas</span>
                    </div>

                    <div class="reel-3d-viewport" id="reelViewport">
                        <div id="reelSpinner" class="reel-spinner"></div>
                        <div id="sonarEffect" class="sonar-container">
                            <div class="sonar-wave"></div>
                            <div class="sonar-wave"></div>
                            <div class="sonar-wave"></div>
                            <div class="text-center text-slate-600 text-xs italic mt-12 font-mono">ESCANEO ACTIVO...
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 3. ACTION -->
                <div class="glass-card p-4 flex flex-col justify-between h-36 border-l-2 border-l-slate-700"
                    id="actionCard">
                    <div class="flex justify-between items-center">
                        <h3 class="text-[10px] font-bold text-slate-500 uppercase tracking-widest">Siguiente Disparo
                        </h3>
                        <span class="text-xs font-mono text-amber-500" id="nextStakeLabel">--</span>
                    </div>
                    <div class="flex-1 flex flex-col items-center justify-center">
                        <div id="actionText" class="text-xs font-bold text-slate-600 tracking-wide text-center">
                            ESPERANDO SE√ëAL...</div>
                        <div id="actionSubtext" class="text-[10px] text-slate-500 mt-1 font-mono text-center"></div>
                    </div>
                    <button id="btnGenerate"
                        class="btn-sniper w-full py-2.5 rounded text-xs font-bold font-tech uppercase tracking-widest flex items-center justify-center gap-2"
                        disabled onclick="openTicketModal()">
                        <span>üéØ</span> DISPARAR
                    </button>
                </div>
            </div>

            <!-- DATA TOOLS & SUMMARY -->
            <div class="mb-4 flex flex-col gap-2">
                <div class="flex gap-2 justify-end items-center mb-2 admin-only" id="dataTools">
                    <button id="btnAdd" class="btn-add" onclick="openManualEntry()">‚ûï ADD</button>
                    <button id="btnEdit" class="btn-edit hidden" onclick="editSelected()">‚úèÔ∏è Editar</button>
                    <button id="btnDelete" class="btn-danger hidden" onclick="deleteSelected()">üóëÔ∏è Eliminar</button>
                    <button id="btnCloudSave"
                        class="px-3 py-1 bg-indigo-700 hover:bg-indigo-600 text-white rounded text-[10px] font-bold uppercase shadow-lg shadow-indigo-900/50 transition-all border border-indigo-500"
                        onclick="manualCloudSync()">‚òÅÔ∏è Save Cloud</button>
                    <button
                        class="px-3 py-1 bg-teal-700 hover:bg-teal-600 text-white rounded text-[10px] font-bold uppercase shadow-lg shadow-teal-900/50 transition-all border border-teal-500 admin-only"
                        onclick="openAdminDataModal()">üõ°Ô∏è DATA</button>
                    <button class="btn-reset" onclick="resetAllData()">‚ö†Ô∏è Reset</button>
                </div>

                <div class="accordion-content bg-slate-900 rounded-lg border border-slate-800 open" id="accContent"
                    style="max-height: 500px">
                    <!-- STATS GRID -->
                    <div
                        class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-px bg-slate-800 border border-slate-800">
                        <div class="bg-[#151e32] flex flex-col">
                            <div class="stat-group-title">I. Riesgo</div>
                            <div class="stat-row"><span class="stat-label">Promedio Gap</span><span
                                    class="stat-value text-cyan-400" id="statAvgGap">--</span></div>
                            <div class="stat-row"><span class="stat-label">Max Gap</span><span
                                    class="stat-value text-amber-500" id="statMaxGap">--</span></div>
                            <div class="stat-row"><span class="stat-label">Total Ciclos</span><span class="stat-value"
                                    id="statTotalCycles">--</span></div>
                            <div class="stat-row"><span class="stat-label">Pasos Promedio</span><span class="stat-value"
                                    id="statAvgSteps">--</span></div>
                        </div>
                        <div class="bg-[#151e32] flex flex-col">
                            <div class="stat-group-title">II. Eficiencia</div>
                            <div class="stat-row"><span class="stat-label">Ganados (TP)</span><span
                                    class="stat-value text-green-400" id="statWins">--</span></div>
                            <div class="stat-row"><span class="stat-label">Perdidos (SL)</span><span
                                    class="stat-value text-red-400" id="statLosses">--</span></div>
                            <div class="stat-row"><span class="stat-label">Win Rate</span><span class="stat-value"
                                    id="statWinRate">--%</span></div>
                        </div>
                        <div class="bg-[#151e32] flex flex-col">
                            <div class="stat-group-title">III. Hits</div>
                            <div class="stat-row"><span class="stat-label">P1 (Gatillo)</span><span
                                    class="stat-value text-cyan-200" id="statHitsP1">--</span></div>
                            <div class="stat-row"><span class="stat-label">P2 (Bono)</span><span class="stat-value"
                                    id="statHitsP2">--</span></div>
                            <div class="stat-row"><span class="stat-label">P3 (Bono)</span><span class="stat-value"
                                    id="statHitsP3">--</span></div>
                            <div class="stat-row"><span class="stat-label">Frecuencia P1</span><span
                                    class="stat-value text-slate-400" id="statFreqP1">--%</span></div>
                        </div>
                        <div class="bg-[#151e32] flex flex-col">
                            <div class="stat-group-title">R. Finanzas</div>
                            <div class="stat-row"><span class="stat-label">P&L Neto</span><span class="stat-value"
                                    id="statPnL">--</span></div>
                            <div class="stat-row"><span class="stat-label">Total Premios</span><span
                                    class="stat-value text-green-400" id="statGrossWin">--</span></div>
                            <div class="stat-row"><span class="stat-label">Max Drawdown</span><span
                                    class="stat-value text-red-500" id="statMDD">--</span></div>
                            <div class="stat-row"><span class="stat-label">Inversi√≥n Total</span><span
                                    class="stat-value text-slate-300" id="statInvTotal">--</span></div>
                            <div class="stat-row"><span class="stat-label">ROI</span><span class="stat-value"
                                    id="statROI">--%</span></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- FILTERS (Dynamic) -->
            <div class="flex flex-col gap-2 mb-2">
                <div class="flex gap-2 items-center flex-wrap">
                    <span class="text-[10px] text-slate-500 font-bold uppercase">Tracks:</span>
                    <div class="flex gap-2 overflow-x-auto pb-1 no-scrollbar" id="filterContainer"></div>
                </div>
                <div class="flex gap-2 items-center border-t border-slate-800 pt-2">
                    <span class="text-[10px] text-slate-500 font-bold uppercase">Rango:</span>
                    <input type="date" id="simStartDate"
                        class="bg-slate-900 border border-slate-700 rounded text-[10px] px-1 text-cyan-500 h-6"
                        onchange="runSimulation()">
                    <input type="date" id="simEndDate"
                        class="bg-slate-900 border border-slate-700 rounded text-[10px] px-1 text-cyan-500 h-6"
                        onchange="runSimulation()">
                    <button class="text-[10px] text-slate-500 hover:text-white underline ml-2"
                        onclick="clearDateFilter()">Limpiar</button>
                    <span class="text-[10px] text-slate-600 italic ml-auto">(Filtra visualizaci√≥n)</span>
                </div>
            </div>

        </div>

        <!-- TABLE SECTION -->
        <div class="table-section">
            <table class="custom-table">
                <thead>
                    <tr>
                        <th class="w-8 text-center px-2"><input type="checkbox" id="selectAll" class="row-checkbox"
                                onclick="toggleSelectAll()"></th>
                        <th class="w-8 text-center px-2 text-slate-500">#</th>
                        <th class="w-20 text-left pl-2">Track</th>
                        <th class="w-24 text-left">Fecha</th>
                        <th class="w-20 text-left">Hora</th>
                        <th>Resultados</th>
                        <th class="w-12 text-center">Gap</th>
                        <th class="w-12 text-center">Paso</th>
                        <th class="w-24 text-right">Unit</th>
                        <th class="w-24 text-right">Total</th>
                        <th class="w-24 text-right">Premio</th>
                        <th class="w-24 text-right">Neto</th>
                        <th class="w-28 text-right pr-4">Balance</th>
                    </tr>
                </thead>
                <tbody id="historyBody">
                    <tr>
                        <td colspan="13" class="text-center py-20 text-slate-600 text-sm italic">Cargando...</td>
                    </tr>
                </tbody>
            </table>
        </div>

    </div>

    <!-- MODALS PLACEHOLDERS (To be filled by core or retained if simple structure preferred) -->
    <!-- SETTINGS MODAL -->
    <div id="settingsModal"
        class="modal-overlay fixed inset-0 hidden z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm">
        <div class="bg-slate-900 border border-slate-700 w-full max-w-sm rounded-xl p-6 shadow-2xl">
            <h2 class="text-white font-bold mb-6 flex items-center gap-2">‚öôÔ∏è Ajustes</h2>
            <div class="space-y-5 text-sm">
                <div><label class="text-slate-400 block mb-1">Stake Inicial Unitario ($)</label><input type="number"
                        id="confStake"
                        class="w-full bg-slate-800 border border-slate-600 rounded p-2 text-white font-mono"
                        step="0.01"></div>
                <div>
                    <label class="text-slate-400 block mb-1">Estrategia</label>
                    <select id="confStrategy"
                        class="w-full bg-slate-800 border border-slate-600 rounded p-2 text-white font-mono"
                        onchange="toggleStrategyParams()">
                        <option value="MARTINGALE">Martingala</option>
                        <option value="FIBONACCI">Fibonacci</option>
                        <option value="KELLY">Criterio de Kelly</option>
                    </select>
                </div>
                <div id="paramContainer">
                    <label class="text-slate-400 block mb-1" id="paramLabel">Multiplicador</label>
                    <input type="number" id="confParam"
                        class="w-full bg-slate-800 border border-slate-600 rounded p-2 text-white font-mono" step="0.1"
                        value="1.7">
                </div>
                <div class="grid grid-cols-2 gap-4">
                    <div><label class="text-slate-400 block mb-1">Gap Trigger</label><input type="number" id="confGap"
                            class="w-full bg-slate-800 border border-slate-600 rounded p-2 text-white font-mono"></div>
                    <div><label class="text-slate-400 block mb-1">Stop Loss</label><input type="number" id="confSL"
                            class="w-full bg-slate-800 border border-slate-600 rounded p-2 text-white font-mono"></div>
                </div>
                <button onclick="saveSettings()"
                    class="w-full bg-cyan-600 hover:bg-cyan-500 text-white font-bold py-3 rounded mt-2">Guardar
                    Cambios</button>
                <button onclick="closeSettings()"
                    class="w-full text-slate-500 hover:text-white py-2 text-xs">Cancelar</button>
            </div>
        </div>
    </div>

    <!-- TICKET MODAL -->
    <div id="ticketModal"
        class="modal-overlay fixed inset-0 hidden z-50 flex items-center justify-center bg-black/90 backdrop-blur-md">
        <div
            class="bg-slate-900 border border-red-500/50 w-full max-w-sm rounded-2xl p-6 shadow-[0_0_50px_rgba(239,68,68,0.2)] text-center relative overflow-hidden">
            <div class="relative z-10">
                <div
                    class="w-12 h-12 bg-red-500/20 rounded-full flex items-center justify-center mx-auto mb-4 text-2xl text-red-500 animate-pulse">
                    üéØ</div>
                <h2 class="text-2xl font-bold font-tech text-white mb-1">DISPARAR</h2>
                <p class="text-slate-400 text-xs mb-4" id="tTrackName"></p>
                <div class="bg-black/40 rounded-lg p-4 mb-6 border border-slate-800 text-left space-y-2 mt-4">
                    <div class="flex justify-between text-sm"><span class="text-slate-400">Paso</span><span
                            class="font-bold text-amber-500 font-mono" id="tStep">#</span></div>
                    <div class="flex justify-between items-center border-t border-slate-800 pt-2 mt-2">
                        <span class="text-slate-300 font-bold text-xs uppercase">Costo Total Ticket</span>
                        <span class="text-2xl font-bold text-green-400 font-tech" id="tTotal">$0.00</span>
                    </div>
                </div>
                <div class="flex gap-3">
                    <button onclick="closeTicketModal()"
                        class="flex-1 py-3 border border-slate-700 rounded-lg text-slate-400 hover:bg-slate-800 text-xs font-bold uppercase">Abortar</button>
                    <button onclick="activeTriggerDispatch()"
                        class="flex-1 bg-red-600 hover:bg-red-500 text-white rounded-lg text-xs font-bold uppercase shadow-lg shadow-red-900/50">CONFIRMAR</button>
                </div>
            </div>
        </div>
    </div>

    <!-- MODAL CONFIRM -->
    <div id="confirmModal"
        class="modal-overlay fixed inset-0 hidden z-[100] flex items-center justify-center bg-black/90 backdrop-blur-sm">
        <div class="bg-slate-900 border border-red-500/50 w-full max-w-sm rounded-xl p-6 shadow-2xl text-center">
            <h3 class="text-white font-bold text-lg mb-2">Confirmaci√≥n</h3>
            <p id="confirmMessage" class="text-slate-400 text-sm mb-6">¬øEst√°s seguro?</p>
            <div class="flex gap-3">
                <button onclick="closeConfirm(false)"
                    class="flex-1 py-2 border border-slate-700 rounded-lg text-slate-400 hover:bg-slate-800 text-xs font-bold uppercase">Cancelar</button>
                <button onclick="closeConfirm(true)"
                    class="flex-1 bg-red-600 hover:bg-red-500 text-white rounded-lg py-2 text-xs font-bold uppercase shadow-lg shadow-red-900/50">Confirmar</button>
            </div>
        </div>
    </div>

    <!-- INJECT REST OF MODALS DYNAMICALLY OR INCLUDE THEM -->
    <!-- For simplicity, I will include placeholder for Converter and Admin Data Modal, but they are driven by sniper-core.js -->

    <!-- CONVERTER MODAL (REQUIRED FOR CORE) -->
    <div id="converterModal"
        class="modal-overlay fixed inset-0 hidden z-[70] flex items-center justify-center bg-black/90 backdrop-blur-md">
        <div
            class="bg-slate-900 border border-cyan-800 w-full max-w-2xl rounded-2xl p-6 shadow-2xl flex flex-col max-h-[90vh] overflow-y-auto">
            <div class="flex justify-between items-center mb-4 border-b border-slate-700 pb-2">
                <h2 class="text-xl font-bold font-tech text-white flex items-center gap-2"><span
                        class="text-cyan-400">üõ†Ô∏è</span> DATA CONVERTER</h2>
                <button onclick="closeConverter()" class="text-slate-400 hover:text-white">‚úï</button>
            </div>
            <!-- Keeping simple skeleton, Core/Engine fills if needed -->
            <div class="p-4">
                <p class="text-slate-400">Standard Converter</p>
                <textarea id="convInput"
                    class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-xs font-mono"></textarea>
                <select id="convType" class="hidden">
                    <option value="p3m">P3M</option>
                </select> <!-- Hidden helper -->
            </div>
        </div>
    </div>

    <!-- ADMIN DATA MODAL -->
    <div id="adminDataModal"
        class="modal-overlay fixed inset-0 hidden z-50 flex items-center justify-center bg-black/90 backdrop-blur-md">
        <div class="bg-slate-900 border border-slate-700 w-full max-w-4xl h-[80vh] rounded-xl flex flex-col shadow-2xl">
            <div class="p-4 border-b border-slate-800 flex justify-between items-center">
                <h3 class="text-amber-500 text-sm">ADMIN</h3><button onclick="closeAdminDataModal()">‚úï</button>
            </div>
            <!-- Filters -->
            <div class="p-4 grid grid-cols-4 gap-2">
                <input type="date" id="admStart"> <input type="date" id="admEnd">
                <select id="admLottery">
                    <option value="ALL">ALL</option>
                </select>
                <button onclick="admSearch()">Search</button>
            </div>
            <div class="flex-1 overflow-auto p-4">
                <table class="w-full">
                    <tbody id="admTableBody"></tbody>
                </table>
            </div>
            <div class="p-2"><span id="admStatus"></span></div>
        </div>
    </div>

    <!-- MANUAL ENTRY MODAL (Stub) -->
    <div id="manualEntryModal" class="hidden"></div>
    <div id="adminEditModal" class="hidden"></div>

    <!-- MODULAR SCRIPTS -->
    <script src="js/sniper-core.js"></script>
    <script src="js/lotto-engine.js"></script>
    <script src="js/horse-engine.js"></script>

    <script>
        // MAIN INIT
        window.addEventListener('load', () => {
            // Init UI Refs
            window.initUI();

            // Init Reel Events
            window.initReelEvents();

            // Execution Mode Toggle
            window.EXECUTION_MODE = 'SIMULATION';
            window.toggleExecutionMode = () => {
                const isChecked = document.getElementById('modeToggle').checked;
                window.EXECUTION_MODE = isChecked ? 'LIVE' : 'SIMULATION';
                document.getElementById('modeLabel').textContent = window.EXECUTION_MODE;
                if (window.runSimulation) window.runSimulation();
            };

            // Engine Dispatcher
            window.switchEngine = (mode) => {
                console.log("Switching Engine:", mode);
                const tableHead = document.querySelector('.custom-table thead tr');

                if (mode === 'HORSE') {
                    if (window.HorseEngine) {
                        window.HorseEngine.run(); // This sets the header
                        if (window.HorseEngine.data.length === 0) {
                            document.getElementById('historyBody').innerHTML = '<tr><td colspan="13" class="text-center py-20 text-slate-500">Motor de Caballos Activo. Carga un CSV.</td></tr>';
                        }
                    }
                } else {
                    // Restore Lotto Header
                    if (tableHead) {
                        tableHead.innerHTML = `
                            <th class="w-8 text-center px-2"><input type="checkbox" id="selectAll" class="row-checkbox" onclick="toggleSelectAll()"></th>
                            <th class="w-8 text-center px-2 text-slate-500">#</th>
                            <th class="w-20 text-left pl-2">Track</th>
                            <th class="w-24 text-left">Fecha</th>
                            <th class="w-20 text-left">Hora</th>
                            <th>Resultados</th>
                            <th class="w-12 text-center">Gap</th>
                            <th class="w-12 text-center">Paso</th>
                            <th class="w-24 text-right">Unit</th>
                            <th class="w-24 text-right">Total</th>
                            <th class="w-24 text-right">Premio</th>
                            <th class="w-24 text-right">Neto</th>
                            <th class="w-28 text-right pr-4">Balance</th>
                        `;
                    }
                    if (window.runSimulation) window.runSimulation();
                }
            };

            if (document.getElementById('csvInput')) document.getElementById('csvInput').addEventListener('change', (e) => {
                const file = e.target.files[0]; if (!file) return;
                const reader = new FileReader();
                reader.onload = (ev) => {
                    const text = ev.target.result;
                    const mode = document.getElementById('engineSelect').value;
                    if (mode === 'HORSE') {
                        window.HorseEngine.parseCSV(text);
                    } else {
                        window.processNewFile(text); // Lotto
                    }
                    document.getElementById('fileName').textContent = `+ ${file.name} (Loaded)`;
                };
                reader.readAsText(file);
            });

            // Load Data
            if (window.loadLocalData) window.loadLocalData();

            // Init Horse Engine (Auto-Load)
            if (window.HorseEngine && window.HorseEngine.init) window.HorseEngine.init();
        });
    </script>
</body>

</html>